library(dplyr)
library(caret)
library(e1071)
library(corrplot)
library(ggplot2)
library(readr)
library(nlme)
setwd(getSrcDirectory()[1])
### Data Cleaning
persian.UCLA = read_xlsx("./PersianVCaucasianEyes.xlsx", sheet = 1)[,2:12]
persian.UCLA = na.omit(persian.UCLA)
persian.UCLA$Ethnicity = "Persian"
caucasian = read_xlsx("./PersianVCaucasianEyes.xlsx", sheet = 2)[,2:12]
caucasian = na.omit(caucasian)
alldata = rbind(persian.UCLA, caucasian)
persian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 3)[,2:9]
persian$Age = as.numeric(alldata %>% filter(Ethnicity == "Persian" & Sex == "M") %>% summarise(Age = median(Age)))
persian$Ethnicity = "Persian"
newAll = rbind(alldata[,c(11,2,5:10,1)], persian)
newTwo = alldata[,c(11,2,5:10,1)]
# output to csv for later use
write.csv(newTwo,file="ann_data.csv")
newTwo$Ethnicity = as.factor(newTwo$Ethnicity)
newAll$Ethnicity = as.factor(newAll$Ethnicity)
persian$Ethnicity = as.factor(persian$Ethnicity)
male = newTwo %>% filter(Sex == "M")
female = newTwo %>% filter(Sex == "F")
###CV Split
smp_siz = floor(0.8*nrow(newTwo))
train_ind = sample(seq_len(nrow(newTwo)),size = smp_siz)
train = newTwo[train_ind,]
test = newTwo[-train_ind,]
smp_siz = floor(0.8*nrow(male))
train_ind = sample(seq_len(nrow(male)),size = smp_siz)
trainMale = male[train_ind,]
testMale = male[-train_ind,]
smp_siz = floor(0.8*nrow(female))
train_ind = sample(seq_len(nrow(female)),size = smp_siz)
trainFemale = female[train_ind,]
testFemale = female[-train_ind,]
###Data Modeling to Predict Ethnicity
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `TPS (L)` + `PTB (L)` + Age + Sex, data = train, family = "binomial")
m2 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` + Age + Sex, data = train, family = "binomial")
m3 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` * Age * Sex, data = train, family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)`*Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)`*Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m2,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m3,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
getSrcDirectory()[1]
getSrcDirectory()
urils::getSrcDirectory()
utils::getSrcDirectory()
??getSrcLocation
setwd("~/Desktop/STATS-141SL")
getSrcDirectory("FinalProj.R")
clear
library(readxl)
library(dplyr)
library(caret)
library(e1071)
library(corrplot)
library(ggplot2)
library(readr)
library(nlme)
setwd(getSrcDirectory()[1])
library(nlme)
### Data Cleaning
persian.UCLA = read_xlsx("./PersianVCaucasianEyes.xlsx", sheet = 1)[,2:12]
persian.UCLA = na.omit(persian.UCLA)
persian.UCLA$Ethnicity = "Persian"
caucasian = read_xlsx("./PersianVCaucasianEyes.xlsx", sheet = 2)[,2:12]
caucasian = na.omit(caucasian)
alldata = rbind(persian.UCLA, caucasian)
persian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 3)[,2:9]
persian$Age = as.numeric(alldata %>% filter(Ethnicity == "Persian" & Sex == "M") %>% summarise(Age = median(Age)))
persian$Ethnicity = "Persian"
newAll = rbind(alldata[,c(11,2,5:10,1)], persian)
newTwo = alldata[,c(11,2,5:10,1)]
# output to csv for later use
write.csv(newTwo,file="ann_data.csv")
newTwo$Ethnicity = as.factor(newTwo$Ethnicity)
newAll$Ethnicity = as.factor(newAll$Ethnicity)
persian$Ethnicity = as.factor(persian$Ethnicity)
male = newTwo %>% filter(Sex == "M")
female = newTwo %>% filter(Sex == "F")
###CV Split
smp_siz = floor(0.8*nrow(newTwo))
train_ind = sample(seq_len(nrow(newTwo)),size = smp_siz)
train = newTwo[train_ind,]
test = newTwo[-train_ind,]
smp_siz = floor(0.8*nrow(male))
train_ind = sample(seq_len(nrow(male)),size = smp_siz)
trainMale = male[train_ind,]
testMale = male[-train_ind,]
smp_siz = floor(0.8*nrow(female))
train_ind = sample(seq_len(nrow(female)),size = smp_siz)
trainFemale = female[train_ind,]
testFemale = female[-train_ind,]
###Data Modeling to Predict Ethnicity
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `TPS (L)` + `PTB (L)` + Age + Sex, data = train, family = "binomial")
m2 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` + Age + Sex, data = train, family = "binomial")
m3 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` * Age * Sex, data = train, family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)`*Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)`*Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
m5 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)`*Age, data = trainMale , family = "binomial")
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m2,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m3,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
?confusionMatrix()
??confusionMatrix()
table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `TPS (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` + `TPS (L)` + `PTB (L)` + Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m2,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m3,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)`*`MRD-1 (R)` + `TPS (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)`*`MRD-1(R)` + `TPS (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
summary(m4)
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `TPS (L)`*`TPS (R)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
summary(m4)
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `TPS (R)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
summary(m4)
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)`+ `PTB (L)` + Age, data = trainFemale , family = "binomial")
summary(m4)
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainMale , family = "binomial")
summary(m4)
summary(m5)
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
###Data Modeling to Predict Ethnicity
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age + Sex, data = train, family = "binomial")
summary(m1)
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
summary(m2)
summary(m3)
library(readxl)
library(dplyr)
library(caret)
library(e1071)
library(corrplot)
library(ggplot2)
library(readr)
library(nlme)
persian.UCLA = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 1)[,2:12]
persian.UCLA = na.omit(persian.UCLA)
persian.UCLA$Ethnicity = "Persian"
caucasian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 2)[,2:12]
caucasian = na.omit(caucasian)
alldata = rbind(persian.UCLA, caucasian)
persian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 3)[,2:9]
persian$Age = as.numeric(alldata %>% filter(Ethnicity == "Persian" & Sex == "M") %>% summarise(Age = median(Age)))
persian$Ethnicity = "Persian"
newAll = rbind(alldata[,c(11,2,5:10,1)], persian)
newTwo = alldata[,c(11,2,5:10,1)]
# output to csv for later use
write.csv(newTwo,file="ann_data.csv")
newTwo$Ethnicity = as.factor(newTwo$Ethnicity)
newAll$Ethnicity = as.factor(newAll$Ethnicity)
persian$Ethnicity = as.factor(persian$Ethnicity)
male = newTwo %>% filter(Sex == "M")
female = newTwo %>% filter(Sex == "F")
smp_siz = floor(0.8*nrow(newTwo))
train_ind = sample(seq_len(nrow(newTwo)),size = smp_siz)
train = newTwo[train_ind,]
test = newTwo[-train_ind,]
smp_siz = floor(0.8*nrow(male))
train_ind = sample(seq_len(nrow(male)),size = smp_siz)
trainMale = male[train_ind,]
testMale = male[-train_ind,]
smp_siz = floor(0.8*nrow(female))
train_ind = sample(seq_len(nrow(female)),size = smp_siz)
trainFemale = female[train_ind,]
testFemale = female[-train_ind,]
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age + Sex, data = train, family = "binomial")
m2 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` + Age + Sex, data = train, family = "binomial")
m3 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` * Age * Sex, data = train, family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m2,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m3,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
library(readxl)
library(dplyr)
library(caret)
library(e1071)
library(corrplot)
library(ggplot2)
library(readr)
library(nlme)
persian.UCLA = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 1)[,2:12]
persian.UCLA = na.omit(persian.UCLA)
persian.UCLA$Ethnicity = "Persian"
caucasian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 2)[,2:12]
caucasian = na.omit(caucasian)
alldata = rbind(persian.UCLA, caucasian)
persian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 3)[,2:9]
persian$Age = as.numeric(alldata %>% filter(Ethnicity == "Persian" & Sex == "M") %>% summarise(Age = median(Age)))
persian$Ethnicity = "Persian"
newAll = rbind(alldata[,c(11,2,5:10,1)], persian)
newTwo = alldata[,c(11,2,5:10,1)]
newTwo$Ethnicity = as.factor(newTwo$Ethnicity)
newAll$Ethnicity = as.factor(newAll$Ethnicity)
persian$Ethnicity = as.factor(persian$Ethnicity)
male = newTwo %>% filter(Sex == "M")
female = newTwo %>% filter(Sex == "F")
smp_siz = floor(0.8*nrow(newTwo))
train_ind = sample(seq_len(nrow(newTwo)),size = smp_siz)
train = newTwo[train_ind,]
test = newTwo[-train_ind,]
write.csv(train,file="ann_train.csv")
write.csv(test,file="ann_test.csv")
smp_siz = floor(0.8*nrow(male))
train_ind = sample(seq_len(nrow(male)),size = smp_siz)
trainMale = male[train_ind,]
testMale = male[-train_ind,]
smp_siz = floor(0.8*nrow(female))
train_ind = sample(seq_len(nrow(female)),size = smp_siz)
trainFemale = female[train_ind,]
testFemale = female[-train_ind,]
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age + Sex, data = train, family = "binomial")
m2 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` + Age + Sex, data = train, family = "binomial")
m3 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` * Age * Sex, data = train, family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m2,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m3,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
library(readxl)
library(dplyr)
library(caret)
library(e1071)
library(corrplot)
library(ggplot2)
library(readr)
library(nlme)
persian.UCLA = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 1)[,2:12]
persian.UCLA = na.omit(persian.UCLA)
persian.UCLA$Ethnicity = "Persian"
caucasian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 2)[,2:12]
caucasian = na.omit(caucasian)
alldata = rbind(persian.UCLA, caucasian)
persian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 3)[,2:9]
persian$Age = as.numeric(alldata %>% filter(Ethnicity == "Persian" & Sex == "M") %>% summarise(Age = median(Age)))
persian$Ethnicity = "Persian"
newAll = rbind(alldata[,c(11,2,5:10,1)], persian)
newTwo = alldata[,c(11,2,5:10,1)]
write.csv(test,file="complete.csv")
newTwo$Ethnicity = as.factor(newTwo$Ethnicity)
newAll$Ethnicity = as.factor(newAll$Ethnicity)
persian$Ethnicity = as.factor(persian$Ethnicity)
male = newTwo %>% filter(Sex == "M")
female = newTwo %>% filter(Sex == "F")
smp_siz = floor(0.8*nrow(newTwo))
train_ind = sample(seq_len(nrow(newTwo)),size = smp_siz)
train = newTwo[train_ind,]
test = newTwo[-train_ind,]
write.csv(train,file="ann_train.csv")
write.csv(test,file="ann_test.csv")
smp_siz = floor(0.8*nrow(male))
train_ind = sample(seq_len(nrow(male)),size = smp_siz)
trainMale = male[train_ind,]
testMale = male[-train_ind,]
smp_siz = floor(0.8*nrow(female))
train_ind = sample(seq_len(nrow(female)),size = smp_siz)
trainFemale = female[train_ind,]
testFemale = female[-train_ind,]
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age + Sex, data = train, family = "binomial")
m2 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` + Age + Sex, data = train, family = "binomial")
m3 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` * Age * Sex, data = train, family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m2,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m3,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
## run random effect model to see how the measures are differed by Ethnicity
random_effect_data <- read_csv("./random_effect_data.csv")
random_effect_MRD = lme(`MRD` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
library(readxl)
library(dplyr)
library(caret)
library(e1071)
library(corrplot)
library(ggplot2)
library(readr)
library(nlme)
persian.UCLA = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 1)[,2:12]
persian.UCLA = na.omit(persian.UCLA)
persian.UCLA$Ethnicity = "Persian"
caucasian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 2)[,2:12]
caucasian = na.omit(caucasian)
alldata = rbind(persian.UCLA, caucasian)
persian = read_xlsx("PersianVCaucasianEyes.xlsx", sheet = 3)[,2:9]
persian$Age = as.numeric(alldata %>% filter(Ethnicity == "Persian" & Sex == "M") %>% summarise(Age = median(Age)))
persian$Ethnicity = "Persian"
newAll = rbind(alldata[,c(11,2,5:10,1)], persian)
newTwo = alldata[,c(11,2,5:10,1)]
write.csv(test,file="complete.csv")
newTwo$Ethnicity = as.factor(newTwo$Ethnicity)
newAll$Ethnicity = as.factor(newAll$Ethnicity)
persian$Ethnicity = as.factor(persian$Ethnicity)
male = newTwo %>% filter(Sex == "M")
female = newTwo %>% filter(Sex == "F")
smp_siz = floor(0.8*nrow(newTwo))
train_ind = sample(seq_len(nrow(newTwo)),size = smp_siz)
train = newTwo[train_ind,]
test = newTwo[-train_ind,]
write.csv(train,file="ann_train.csv")
write.csv(test,file="ann_test.csv")
smp_siz = floor(0.8*nrow(male))
train_ind = sample(seq_len(nrow(male)),size = smp_siz)
trainMale = male[train_ind,]
testMale = male[-train_ind,]
smp_siz = floor(0.8*nrow(female))
train_ind = sample(seq_len(nrow(female)),size = smp_siz)
trainFemale = female[train_ind,]
testFemale = female[-train_ind,]
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age + Sex, data = train, family = "binomial")
m2 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` + Age + Sex, data = train, family = "binomial")
m3 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` * Age * Sex, data = train, family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m2,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m3,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
## run random effect model to see how the measures are differed by Ethnicity
random_effect_data <- read_csv("./random_effect_data.csv")
random_effect_MRD = lme(`MRD` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_PTB = lme(`PTB` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_TPS = lme(`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_TPS = lme(`MRD`/`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
summary(random_effect_MRD)
summary(random_effect_PTB)
summary(random_effect_TPS)
## run random effect model to see how the measures are differed by Ethnicity
random_effect_data <- read_csv("./random_effect_data.csv")
random_effect_MRD = lme(`MRD` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_PTB = lme(`PTB` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_TPS = lme(`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_MRD_TPS = lme(`MRD`/`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_MRD_PTB = lme(`MRD`/`PTB` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_PTB_TPS = lme(`PTB`/`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
summary(random_effect_MRD)
summary(random_effect_PTB)
summary(random_effect_TPS)
summary(random_effect_MRD_TPS)
summary(random_effect_MRD_PTB)
summary(random_effect_PTB_TPS)
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + `MRD-1 (L)`/`PTB (L)` + Age + Sex, data = train, family = "binomial")
m2 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` + Age + Sex, data = train, family = "binomial")
m3 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` * Age * Sex, data = train, family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + I(`MRD-1 (L)`/`PTB (L)`) + Age + Sex, data = train, family = "binomial")
m2 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` + Age + Sex, data = train, family = "binomial")
m3 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` * Age * Sex, data = train, family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m2,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m3,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
# All
m1 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age + Sex, data = train, family = "binomial")
m2 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` + Age + Sex, data = train, family = "binomial")
m3 = glm(Ethnicity ~ `MRD-1 (L)` * `TPS (L)` * `PTB (L)` * Age * Sex, data = train, family = "binomial")
# Male/Female
m4 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainFemale , family = "binomial")
m5 = glm(Ethnicity ~ `MRD-1 (L)` + `PTB (L)` + Age, data = trainMale , family = "binomial")
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
confusionMatrix(table(predict(m1,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m2,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m3,test[,1:8],type = 'response') >=0.5,test$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m4,testFemale[,1:8],type = 'response') >=0.5,testFemale$Ethnicity=="Persian"))[3]
confusionMatrix(table(predict(m5,testMale[,1:8],type = 'response') >=0.5,testMale$Ethnicity=="Persian"))[3]
## run random effect model to see how the measures are differed by Ethnicity
random_effect_data <- read_csv("./random_effect_data.csv")
random_effect_MRD = lme(`MRD` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_PTB = lme(`PTB` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_TPS = lme(`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_MRD_TPS = lme(`MRD`*`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_MRD_PTB = lme(`MRD`/`PTB` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_PTB_TPS = lme(`PTB`*`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
summary(random_effect_MRD)
summary(random_effect_PTB)
summary(random_effect_TPS)
summary(random_effect_MRD_TPS)
summary(random_effect_MRD_PTB)
summary(random_effect_PTB_TPS)
## run random effect model to see how the measures are differed by Ethnicity
random_effect_data <- read_csv("./random_effect_data.csv")
random_effect_MRD = lme(`MRD` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_PTB = lme(`PTB` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_TPS = lme(`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_MRD_TPS = lme(`MRD`*`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_MRD_PTB = lme(I(`MRD`/`PTB`) ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_PTB_TPS = lme(`PTB`*`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
summary(random_effect_MRD)
summary(random_effect_PTB)
summary(random_effect_TPS)
summary(random_effect_MRD_TPS)
summary(random_effect_MRD_PTB)
summary(random_effect_PTB_TPS)
## run random effect model to see how the measures are differed by Ethnicity
random_effect_data <- read_csv("./random_effect_data.csv")
random_effect_MRD = lme(`MRD` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_PTB = lme(`PTB` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_TPS = lme(`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_MRD_TPS = lme(`MRD`/`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_MRD_PTB = lme(`MRD`/`PTB` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
random_effect_PTB_TPS = lme(`PTB`/`TPS` ~ Ethnicity + Sex + Age, random_effect_data, random=~1|Person)
summary(random_effect_MRD)
summary(random_effect_PTB)
summary(random_effect_TPS)
summary(random_effect_MRD_TPS)
summary(random_effect_MRD_PTB)
summary(random_effect_PTB_TPS)
